# Logs Directory

This directory contains application log files that are generated by the application's logging system.

## Log File Format

Log files follow this naming convention:
- Active log: `<app_name>.log`
- Rotated logs: `<app_name>.log.<timestamp>`

The application uses Python's `TimedRotatingFileHandler` to rotate logs daily at midnight. Each rotated log file contains the logs from a single day.

## Log Upload to Azure Blob Storage

When configured, rotated log files are automatically uploaded to Azure Blob Storage. This provides:
- Long-term archival of logs
- Centralized storage across multiple application instances
- Ability to analyze logs across the entire system

### Configuration

To enable log uploads to Azure Blob Storage, set the following environment variables:

```bash
# Azure Storage Account URL
AZURE_STORAGE_ACCOUNT_URL=https://youraccount.blob.core.windows.net

# Container name for logs (default: application-logs)
AZURE_LOGS_CONTAINER_NAME=application-logs

# Retention period in days (default: 30)
AZURE_LOGS_RETENTION_DAYS=30

# How often to scan for rotated logs in seconds (default: 60)
LOG_SCAN_INTERVAL=60
```

### How It Works

1. The application initializes a `LogMonitorService` during startup
2. The service periodically scans this directory for rotated log files
3. When a rotated file is found, it's uploaded to Azure Blob Storage
4. Uploads happen asynchronously in the background without blocking the main application
5. Files are stored with expiration policies based on the configured retention period

### Storage Structure

In the Azure Blob Storage container, logs are stored with the same filename as the local rotated logs:

```
application-logs/
  ├── unknown_app.log.2023-07-01
  ├── unknown_app.log.2023-07-02
  ├── feedback_form_app.log.2023-07-01
  ├── feedback_form_app.log.2023-07-02
  ├── token_counter_app.log.2023-07-01
  └── token_counter_app.log.2023-07-02
```

### Security

The application uses Azure Identity's `DefaultAzureCredential` for authentication, which supports:
- Environment variables
- Managed identities
- Azure CLI credentials
- Visual Studio Code credentials

This ensures secure access to the blob storage without hardcoded credentials. 